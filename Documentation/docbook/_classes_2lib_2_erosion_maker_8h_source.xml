<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__classes_2lib_2_erosion_maker_8h_source" xml:lang="en-US">
<title>ErosionMaker.h</title>
<indexterm><primary>C:/Users/HP/Documents/GitHub/Minero-Game/Classes/lib/ErosionMaker.h</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered">1 <emphasis role="preprocessor">#ifndef&#32;EROSION_MAKER</emphasis>
2 <emphasis role="preprocessor">#define&#32;EROSION_MAKER</emphasis>
3 
4 <emphasis role="preprocessor">#include&#32;&lt;iostream&gt;</emphasis>
5 <emphasis role="preprocessor">#include&#32;&lt;vector&gt;</emphasis>
6 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__old_2_classes_2lib_2raylib_2src_2raylib_8h">raylib.h</link>&quot;</emphasis>
7 
8 <emphasis role="comment">//&#32;used&#32;to&#32;sample&#32;a&#32;point&#32;in&#32;the&#32;heightmap&#32;and&#32;get&#32;the&#32;gradient</emphasis>
9 <emphasis role="keyword">typedef</emphasis>&#32;<emphasis role="keyword">struct</emphasis>
10 {
11 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_struct_height_and_gradient_1a8c52112b0bfda477dcbbb269f71fc316">height</link>;
12 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_struct_height_and_gradient_1a110de06401e2d6f3eeeed6477a22e62b">gradientX</link>;
13 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_struct_height_and_gradient_1a783e242d850cb6ba9b9b7f2e7bb57f06">gradientY</link>;
14 }&#32;<link linkend="_struct_height_and_gradient">HeightAndGradient</link>;
15 
16 <emphasis role="comment">//&#32;describes&#32;the&#32;shape&#32;of&#32;the&#32;smoothing&#32;to&#32;apply&#32;to&#32;map&#32;borders</emphasis>
17 <emphasis role="keyword">enum</emphasis>&#32;<link linkend="__classes_2lib_2_erosion_maker_8h_1a0bb3c96a5ae4411bf72bdafaaaaec12a">GradientType</link>
18 {
19 &#32;&#32;&#32;&#32;<link linkend="__classes_2lib_2_erosion_maker_8h_1a0bb3c96a5ae4411bf72bdafaaaaec12aa4233fbf0cafb86abcee94b38d769fc59">SQUARE</link>&#32;=&#32;0,
20 &#32;&#32;&#32;&#32;<link linkend="__classes_2lib_2_erosion_maker_8h_1a0bb3c96a5ae4411bf72bdafaaaaec12aaa79c827759ea48f0735386c4b1188911">CIRCLE</link>&#32;=&#32;1,
21 &#32;&#32;&#32;&#32;<link linkend="__classes_2lib_2_erosion_maker_8h_1a0bb3c96a5ae4411bf72bdafaaaaec12aa714f2cc5c292a305e2da3c03bd63916a">DIAMOND</link>&#32;=&#32;2,
22 &#32;&#32;&#32;&#32;<link linkend="__classes_2lib_2_erosion_maker_8h_1a0bb3c96a5ae4411bf72bdafaaaaec12aa9d398750ed310ae69cd070016810e4dc">STAR</link>&#32;=&#32;3,
23 };
24 
25 <emphasis role="comment">//&#32;singleton&#32;responsible&#32;for&#32;simulating&#32;erosion&#32;on&#32;a&#32;heightmap</emphasis>
26 <emphasis role="keyword">class&#32;</emphasis><link linkend="_class_erosion_maker">ErosionMaker</link>
27 {
28 <emphasis role="keyword">public</emphasis>:
29 &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<link linkend="_class_erosion_maker">ErosionMaker</link>&amp;&#32;<link linkend="_class_erosion_maker_1ae17d133e10e155b6e26674fa588d6453">GetInstance</link>()
30 &#32;&#32;&#32;&#32;{
31 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<link linkend="_class_erosion_maker">ErosionMaker</link>&#32;instance;&#32;<emphasis role="comment">//&#32;Guaranteed&#32;to&#32;be&#32;destroyed.</emphasis>
32 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Instantiated&#32;on&#32;first&#32;use.</emphasis>
33 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;instance;
34 &#32;&#32;&#32;&#32;}
35 
36 <emphasis role="keyword">private</emphasis>:
37 &#32;&#32;&#32;&#32;<link linkend="_class_erosion_maker">ErosionMaker</link>()&#32;{}&#32;<emphasis role="comment">//&#32;Constructor?&#32;(the&#32;{}&#32;brackets)&#32;are&#32;needed&#32;here.</emphasis>
38 
39 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;C++&#32;03</emphasis>
40 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;========</emphasis>
41 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Don&apos;t&#32;forget&#32;to&#32;declare&#32;these&#32;two.&#32;You&#32;want&#32;to&#32;make&#32;sure&#32;they</emphasis>
42 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;are&#32;inaccessible(especially&#32;from&#32;outside),&#32;otherwise,&#32;you&#32;may&#32;accidentally&#32;get&#32;copies&#32;of</emphasis>
43 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;your&#32;singleton&#32;appearing.</emphasis>
44 &#32;&#32;&#32;&#32;<link linkend="_class_erosion_maker">ErosionMaker</link>(<link linkend="_class_erosion_maker">ErosionMaker</link>&#32;<emphasis role="keyword">const</emphasis>&amp;);&#32;&#32;&#32;<emphasis role="comment">//&#32;Don&apos;t&#32;Implement</emphasis>
45 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;operator=(<link linkend="_class_erosion_maker">ErosionMaker</link>&#32;<emphasis role="keyword">const</emphasis>&amp;);&#32;<emphasis role="comment">//&#32;Don&apos;t&#32;Implement</emphasis>
46 
47 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;C++&#32;11</emphasis>
48 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;=======</emphasis>
49 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;We&#32;can&#32;use&#32;the&#32;better&#32;technique&#32;of&#32;deleting&#32;the&#32;methods</emphasis>
50 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;we&#32;don&apos;t&#32;want.</emphasis>
51 
52 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;indices&#32;and&#32;weights&#32;of&#32;erosion&#32;brush&#32;precomputed&#32;for&#32;every&#32;cell</emphasis>
53 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;it&apos;s&#32;a&#32;cache&#32;used&#32;to&#32;speed&#32;up&#32;the&#32;area&#32;of&#32;effect&#32;erosion&#32;of&#32;a&#32;droplet</emphasis>
54 &#32;&#32;&#32;&#32;std::vector&lt;std::vector&lt;int&gt;*&gt;*&#32;erosionBrushIndices&#32;=&#32;<emphasis role="keyword">nullptr</emphasis>;&#32;<emphasis role="comment">//&#32;for&#32;each&#32;cell,&#32;a&#32;reference&#32;to&#32;neighbors&#32;is&#32;held</emphasis>
55 &#32;&#32;&#32;&#32;std::vector&lt;std::vector&lt;float&gt;*&gt;*&#32;erosionBrushWeights&#32;=&#32;<emphasis role="keyword">nullptr</emphasis>;&#32;<emphasis role="comment">//&#32;for&#32;each&#32;cell,&#32;a&#32;reference&#32;to&#32;how&#32;much&#32;it&#32;influences&#32;neighbors</emphasis>
56 
57 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;currentSeed;&#32;<emphasis role="comment">//&#32;current&#32;random&#32;seed</emphasis>
58 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;currentErosionRadius;&#32;
59 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;currentMapSize;
60 
61 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;Initialize(<emphasis role="keywordtype">int</emphasis>&#32;mapSize,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;resetSeed);&#32;
62 &#32;&#32;&#32;&#32;<link linkend="_struct_height_and_gradient">HeightAndGradient</link>&#32;CalculateHeightAndGradient(std::vector&lt;float&gt;*&#32;nodes,&#32;<emphasis role="keywordtype">int</emphasis>&#32;mapSize,&#32;<emphasis role="keywordtype">float</emphasis>&#32;posX,&#32;<emphasis role="keywordtype">float</emphasis>&#32;posY);&#32;<emphasis role="comment">//&#32;calculates&#32;height&#32;and&#32;gradient&#32;of&#32;a&#32;spot&#32;in&#32;the&#32;map</emphasis>
63 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;InitializeBrushIndices(<emphasis role="keywordtype">int</emphasis>&#32;mapSize,&#32;<emphasis role="keywordtype">int</emphasis>&#32;radius);&#32;<emphasis role="comment">//&#32;initialize&#32;the&#32;brush&#32;cache</emphasis>
64 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;RemapValue(<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_classvalue">value</link>);&#32;<emphasis role="comment">//&#32;remaps&#32;a&#32;single&#32;value&#32;of&#32;a&#32;map&#32;to&#32;nonlinear&#32;scale&#32;in&#32;order&#32;to&#32;smooth&#32;beach&#32;areas</emphasis>
65 
66 <emphasis role="keyword">public</emphasis>:
67 &#32;&#32;&#32;&#32;<emphasis role="comment">//ErosionMaker(ErosionMaker&#32;const&#32;&amp;)&#32;=&#32;delete;</emphasis>
68 &#32;&#32;&#32;&#32;<emphasis role="comment">//void&#32;operator=(ErosionMaker&#32;const&#32;&amp;)&#32;=&#32;delete;</emphasis>
69 
70 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Note:&#32;Scott&#32;Meyers&#32;mentions&#32;in&#32;his&#32;Effective&#32;Modern</emphasis>
71 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;C++&#32;book,&#32;that&#32;deleted&#32;functions&#32;should&#32;generally</emphasis>
72 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;be&#32;public&#32;as&#32;it&#32;results&#32;in&#32;better&#32;error&#32;messages</emphasis>
73 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;due&#32;to&#32;the&#32;compilers&#32;behavior&#32;to&#32;check&#32;accessibility</emphasis>
74 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;before&#32;deleted&#32;status</emphasis>
75 
76 &#32;&#32;&#32;&#32;<emphasis role="comment">//int&#32;seed&#32;=&#32;0;</emphasis>
77 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_class_erosion_maker_1ada80269398495d003387712899065a61">erosionRadius</link>&#32;=&#32;6;<emphasis role="comment">//12;&#32;//&#32;Range&#32;(2,&#32;8)</emphasis>
78 
79 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1a4c7d7ab3878902a01645b7e569853d2c">inertia</link>&#32;=&#32;0.05f;&#32;<emphasis role="comment">//&#32;range&#32;(0,&#32;1)&#32;at&#32;zero,&#32;water&#32;will&#32;instantly&#32;change&#32;direction&#32;to&#32;flow&#32;downhill.&#32;At&#32;1,&#32;water&#32;will&#32;never&#32;change&#32;direction.&#32;</emphasis>
80 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1a145958461d6aaed4636f5f6b4bc57766">sedimentCapacityFactor</link>&#32;=&#32;6.0f;&#32;<emphasis role="comment">//&#32;multiplier&#32;for&#32;how&#32;much&#32;sediment&#32;a&#32;droplet&#32;can&#32;carry</emphasis>
81 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1a7f1fcc0bb9a87e2c1267505e53004e65">minSedimentCapacity</link>&#32;=&#32;0.01f;&#32;<emphasis role="comment">//&#32;used&#32;to&#32;prevent&#32;carry&#32;capacity&#32;getting&#32;too&#32;close&#32;to&#32;zero&#32;on&#32;flatter&#32;terrain</emphasis>
82 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1a3b33e6f9d2ad0b1be808711c7789fd68">erodeSpeed</link>&#32;=&#32;0.3f;&#32;<emphasis role="comment">//&#32;range&#32;(0,&#32;1)&#32;how&#32;easily&#32;a&#32;droplet&#32;removes&#32;sediment</emphasis>
83 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1acb95634449d3c7f804f9c3fc766a4630">depositSpeed</link>&#32;=&#32;0.3f;&#32;<emphasis role="comment">//&#32;range&#32;(0,&#32;1)&#32;how&#32;easily&#32;a&#32;droplet&#32;deposits&#32;sediment</emphasis>
84 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1a7e4593b2f48a8cf116d982a6503004ba">evaporateSpeed</link>&#32;=&#32;0.01f;&#32;<emphasis role="comment">//&#32;range&#32;(0,&#32;1)&#32;droplets&#32;evaporate&#32;during&#32;their&#32;lifetime,&#32;reducing&#32;mass</emphasis>
85 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1a84968a5d762c48d0905a26304edc13a0">gravity</link>&#32;=&#32;4.0f;&#32;<emphasis role="comment">//&#32;determines&#32;speed&#32;increase&#32;of&#32;the&#32;droplet&#32;upon&#32;a&#32;slope</emphasis>
86 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_class_erosion_maker_1a8a14aa1a5d018f8ac105db4ef88c1615">maxDropletLifetime</link>&#32;=&#32;60;
87 
88 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1ab9e42b27af2cbded22a126bb0f15f9d6">initialWaterVolume</link>&#32;=&#32;1;
89 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_erosion_maker_1a53458611e9186e3b0e767750cc97fc76">initialSpeed</link>&#32;=&#32;1;
90 
91 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_class_erosion_maker_1a16fc934b9484b727647d827071cac841">Erode</link>(std::vector&lt;float&gt;*&#32;map,&#32;<emphasis role="keywordtype">int</emphasis>&#32;mapSize,&#32;<emphasis role="keywordtype">int</emphasis>&#32;numIterations&#32;=&#32;1,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;resetSeed&#32;=&#32;<emphasis role="keyword">false</emphasis>);&#32;<emphasis role="comment">//&#32;applies&#32;erosion&#32;to&#32;the&#32;map</emphasis>
92 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_class_erosion_maker_1abad42d1d3d1aecfeea9bffc3f10e2f40">Gradient</link>(std::vector&lt;float&gt;*&#32;map,&#32;<emphasis role="keywordtype">int</emphasis>&#32;mapSize,&#32;<emphasis role="keywordtype">float</emphasis>&#32;normalizedOffset,&#32;<link linkend="__old_2_classes_2lib_2_erosion_maker_8h_1a0bb3c96a5ae4411bf72bdafaaaaec12a">GradientType</link>&#32;gradientType);&#32;<emphasis role="comment">//&#32;allpies&#32;a&#32;gradient&#32;to&#32;the&#32;map&#32;in&#32;order&#32;to&#32;get&#32;flat&#32;borders</emphasis>
93 &#32;&#32;&#32;&#32;<link linkend="_struct_vector3">Vector3</link>&#32;<link linkend="_class_erosion_maker_1a60848ae7b0dbef403350fcd71d456b71">GetNormal</link>(std::vector&lt;float&gt;*&#32;map,&#32;<emphasis role="keywordtype">int</emphasis>&#32;mapSize,&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__classes_2lib_2raylib_2src_2external_2_a_n_g_l_e_2_e_g_l_2eglext_8h_1ac916c0825494ac3acd4457effd2823d2">x</link>,&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__classes_2lib_2raylib_2src_2external_2_a_n_g_l_e_2_e_g_l_2eglext_8h_1a4f27f1eebce8c31db01bb39fab9ef561">y</link>);&#32;<emphasis role="comment">//&#32;gets&#32;the&#32;normal&#32;of&#32;a&#32;point&#32;in&#32;the&#32;map&#32;using&#32;interpolation</emphasis>
94 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_class_erosion_maker_1a323c5b8e483ad5bb71db4df28e9fd1f6">Remap</link>(std::vector&lt;float&gt;*&#32;map,&#32;<emphasis role="keywordtype">int</emphasis>&#32;mapSize);&#32;<emphasis role="comment">//&#32;applies&#32;a&#32;filter&#32;to&#32;the&#32;map&#32;in&#32;order&#32;to&#32;flatten&#32;beach&#32;areas&#32;by&#32;remapping&#32;normalized&#32;values</emphasis>
95 };
96 
97 <emphasis role="preprocessor">#endif</emphasis>
</programlisting></section>
